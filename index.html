<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Darts PRO | Sree</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ff88; --bg: #000; --surf: #0a0a0a; --text: #fff; --dim: #666; --border: #1a1a1a; --danger: #ff4444; --nav-bg: rgba(255,255,255,0.05); }
        [data-theme="light"] { --bg: #f5f5f7; --surf: #fff; --text: #1d1d1f; --dim: #86868b; --border: #e0e0e0; --accent: #00bd65; --nav-bg: rgba(0,0,0,0.03); }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body, html { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; height: 100vh; overflow: hidden; transition: background 0.3s; }
        .app-container { height: 100%; display: flex; flex-direction: column; padding: 10px; max-width: 500px; margin: 0 auto; position: relative; }
        .screen { display: none; flex-direction: column; height: 100%; width: 100%; }
        .screen.active { display: flex; }

        /* Side Menu */
        .side-menu { position: fixed; top: 0; left: -280px; width: 280px; height: 100%; background: var(--surf); z-index: 1000; transition: 0.4s; padding: 50px 30px; border-right: 1px solid var(--border); }
        .side-menu.open { left: 0; box-shadow: 20px 0 80px rgba(0,0,0,0.5); }
        .menu-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 999; backdrop-filter: blur(4px); }
        .menu-item { padding: 20px 0; font-size: 1rem; border-bottom: 1px solid var(--border); cursor: pointer; display: flex; align-items: center; gap: 15px; color: var(--text); }
        .menu-item span { color: var(--accent); font-weight: 900; font-size: 0.7rem; }

        /* Top Nav */
        .top-nav { display: flex; justify-content: space-between; align-items: center; height: 50px; flex-shrink: 0; }
        .nav-btn { width: 40px; height: 40px; background: var(--nav-bg); border-radius: 10px; border: 1px solid var(--border); display: flex; justify-content: center; align-items: center; cursor: pointer; color: var(--text); }

        /* Welcome Screen */
        .hero { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .hero h1 { font-size: 3.5rem; font-weight: 900; letter-spacing: -3px; line-height: 0.9; }
        .hero h1 span { color: var(--accent); }
        .hero-sub { color: var(--dim); font-size: 0.6rem; letter-spacing: 4px; text-transform: uppercase; margin-top: 10px; }

        /* CRICKET SCORING LAYOUT */
        .cricket-grid { display: flex; flex-direction: row; justify-content: space-between; align-items: center; flex-grow: 1; width: 100%; gap: 5px; margin: 10px 0; }
        
        .player-col { width: 60px; display: flex; flex-direction: column; gap: 4px; align-items: center; opacity: 0.2; transition: 0.3s; }
        .player-col.active { opacity: 1; transform: scale(1.05); }
        
        .p-total-box { text-align: center; margin-bottom: 5px; }
        .p-name-tag { font-size: 0.55rem; font-weight: 800; color: var(--dim); text-transform: uppercase; max-width: 60px; overflow: hidden; white-space: nowrap; }
        .p-total-score { font-size: 1.4rem; font-weight: 900; color: var(--accent); line-height: 1; }
        
        .mark-cell { width: 42px; height: 35px; background: var(--surf); border: 1px solid var(--border); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 1.1rem; position: relative; }
        .mark-val-label { font-size: 0.5rem; color: var(--dim); font-weight: 900; }

        /* Center Board Box */
        .board-center { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; min-width: 0; }
        #dartboard-svg { width: 100%; height: auto; max-width: 260px; }
        .db-bg { fill: var(--text); }
        .db-seg-even { fill: #111; stroke: #222; stroke-width: 0.2; }
        .db-seg-odd { fill: #050505; stroke: #222; stroke-width: 0.2; }
        .db-red { fill: #8b0000; }
        .db-green { fill: #004d2c; }
        .db-highlight { fill: var(--accent) !important; }
        .db-text { fill: #555; font-size: 6px; font-weight: 700; pointer-events: none; }

        /* Scorestrip & Buttons */
        .bottom-area { padding-top: 10px; }
        .score-strip { display: flex; gap: 8px; margin-bottom: 12px; justify-content: center; }
        .dart-slot { width: 60px; height: 50px; background: var(--surf); border: 1px solid var(--border); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 900; color: var(--accent); font-size: 1.2rem; }
        .miss-btn { width: 60px; height: 50px; background: var(--danger); border-radius: 10px; border: none; color: #fff; font-size: 0.6rem; font-weight: 900; cursor: pointer; }
        
        .cta { width: 100%; padding: 18px; background: var(--text); color: var(--bg); border-radius: 14px; font-weight: 900; text-transform: uppercase; border: none; font-size: 0.8rem; cursor: pointer; }
        .cta-submit { width: 100%; padding: 18px; background: var(--accent); color: #000; border-radius: 14px; font-weight: 900; border: none; text-transform: uppercase; cursor: pointer; }
        .undo-link { color: var(--dim); font-size: 0.7rem; text-align: center; margin-top: 10px; cursor: pointer; text-decoration: underline; }

        .name-input { width: 100%; background: var(--surf); border: 1px solid var(--border); padding: 18px; color: var(--text); border-radius: 12px; margin-bottom: 12px; text-align: center; font-weight: 700; outline: none; }
    </style>
</head>
<body>

<div class="menu-overlay" id="overlay" onclick="toggleMenu()"></div>
<div class="side-menu" id="side-menu">
    <div class="menu-item" onclick="toggleTheme()"><span>01</span> SWITCH THEME</div>
    <div class="menu-item" onclick="location.reload()"><span>02</span> NEW MATCH</div>
    <div class="menu-item" onclick="toggleMenu()"><span>03</span> CLOSE MENU</div>
</div>

<div class="app-container">
    <div class="top-nav">
        <div class="nav-btn" onclick="toggleMenu()">â˜°</div>
        <div class="hero-sub" id="status-text">CRICKET PRO</div>
        <div class="nav-btn" onclick="toggleTheme()" id="theme-icon">ðŸŒ™</div>
    </div>

    <div id="scr-welcome" class="screen active">
        <div class="hero">
            <h1>Darts <span>PRO</span></h1>
            <div class="hero-sub">Engineered by Sree</div>
        </div>
        <button class="cta" onclick="nav('scr-setup')">Start Game</button>
    </div>

    <div id="scr-setup" class="screen">
        <div class="hero" style="flex-grow:0; margin: 30px 0;"><div class="hero-sub">Enter Names</div></div>
        <input type="text" id="p1-name" class="name-input" placeholder="PLAYER 1">
        <input type="text" id="p2-name" class="name-input" placeholder="PLAYER 2">
        <div style="flex-grow:1"></div>
        <button class="cta" onclick="initCricket()">Start Cricket</button>
    </div>

    <div id="scr-game" class="screen">
        <div class="cricket-grid">
            <div id="col-0" class="player-col">
                <div class="p-total-box"><div id="n0" class="p-name-tag">P1</div><div id="pts-0" class="p-total-score">0</div></div>
                <div class="mark-val-label">20</div><div id="m0-20" class="mark-cell">-</div>
                <div class="mark-val-label">19</div><div id="m0-19" class="mark-cell">-</div>
                <div class="mark-val-label">18</div><div id="m0-18" class="mark-cell">-</div>
                <div class="mark-val-label">17</div><div id="m0-17" class="mark-cell">-</div>
                <div class="mark-val-label">16</div><div id="m0-16" class="mark-cell">-</div>
                <div class="mark-val-label">15</div><div id="m0-15" class="mark-cell">-</div>
                <div class="mark-val-label">BULL</div><div id="m0-25" class="mark-cell">-</div>
            </div>

            <div class="board-center">
                <div id="active-tag" style="font-size:0.6rem; color:var(--accent); font-weight:900; margin-bottom:8px;">TURN: PLAYER 1</div>
                <svg id="dartboard-svg" viewBox="0 0 200 200">
                    <circle cx="100" cy="100" r="98" class="db-bg"/>
                    <g id="board-segs"></g>
                    <circle id="s25" cx="100" cy="100" r="12" class="db-green" onclick="processHit(25, 1)"/>
                    <circle id="d25" cx="100" cy="100" r="6" class="db-red" onclick="processHit(25, 2)"/>
                </svg>
            </div>

            <div id="col-1" class="player-col">
                <div class="p-total-box"><div id="n1" class="p-name-tag">P2</div><div id="pts-1" class="p-total-score">0</div></div>
                <div class="mark-val-label">20</div><div id="m1-20" class="mark-cell">-</div>
                <div class="mark-val-label">19</div><div id="m1-19" class="mark-cell">-</div>
                <div class="mark-val-label">18</div><div id="m1-18" class="mark-cell">-</div>
                <div class="mark-val-label">17</div><div id="m1-17" class="mark-cell">-</div>
                <div class="mark-val-label">16</div><div id="m1-16" class="mark-cell">-</div>
                <div class="mark-val-label">15</div><div id="m1-15" class="mark-cell">-</div>
                <div class="mark-val-label">BULL</div><div id="m1-25" class="mark-cell">-</div>
            </div>
        </div>

        <div class="bottom-area">
            <div class="score-strip">
                <div id="ds0" class="dart-slot">-</div><div id="ds1" class="dart-slot">-</div><div id="ds2" class="dart-slot">-</div>
                <button class="miss-btn" onclick="processHit(0,1)">MISS</button>
            </div>
            <button id="sub-btn" class="cta-submit" style="opacity:0.2; pointer-events:none;" onclick="nextTurn()">Submit Turn</button>
            <div class="undo-link" onclick="undoHit()">Undo Last Dart</div>
        </div>
    </div>

    <div id="scr-win" class="screen">
        <div class="hero">
            <div class="hero-sub">Match Won By</div>
            <h1 id="winner-name" style="color:var(--accent)">-</h1>
        </div>
        <button class="cta" onclick="location.reload()">Restart</button>
    </div>
</div>

<script>
    let players = [], turn = 0, currentDarts = [], stateHistory = [];
    const cricketTargets = [20, 19, 18, 17, 16, 15, 25];
    const ringOrder = [20, 1, 18, 4, 13, 6, 10, 15, 2, 17, 3, 19, 7, 16, 8, 11, 14, 9, 12, 5];

    function toggleMenu() {
        const menu = document.getElementById('side-menu');
        const overlay = document.getElementById('overlay');
        menu.classList.toggle('open');
        overlay.style.display = menu.classList.contains('open') ? 'block' : 'none';
    }

    function toggleTheme() {
        const root = document.documentElement;
        const isDark = root.getAttribute('data-theme') === 'dark';
        root.setAttribute('data-theme', isDark ? 'light' : 'dark');
        document.getElementById('theme-icon').innerText = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
        if(document.getElementById('side-menu').classList.contains('open')) toggleMenu();
    }

    function nav(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function initCricket() {
        players = [
            { name: (document.getElementById('p1-name').value || "P1").toUpperCase(), score: 0, marks: {20:0,19:0,18:0,17:0,16:0,15:0,25:0} },
            { name: (document.getElementById('p2-name').value || "P2").toUpperCase(), score: 0, marks: {20:0,19:0,18:0,17:0,16:0,15:0,25:0} }
        ];
        document.getElementById('n0').innerText = players[0].name;
        document.getElementById('n1').innerText = players[1].name;
        renderBoard();
        updateDisplay();
        nav('scr-game');
    }

    function renderBoard() {
        const group = document.getElementById('board-segs');
        group.innerHTML = "";
        ringOrder.forEach((v, i) => {
            const angle = (i * 18) - 108; // Offset for dartboard layout
            const arc = (r1, r2, cls, m) => {
                const rad = Math.PI / 180;
                const x1 = 100 + r1 * Math.cos(angle * rad), y1 = 100 + r1 * Math.sin(angle * rad);
                const x2 = 100 + r1 * Math.cos((angle+18) * rad), y2 = 100 + r1 * Math.sin((angle+18) * rad);
                const x3 = 100 + r2 * Math.cos((angle+18) * rad), y3 = 100 + r2 * Math.sin((angle+18) * rad);
                const x4 = 100 + r2 * Math.cos(angle * rad), y4 = 100 + r2 * Math.sin(angle * rad);
                return `<path d="M${x1},${y1} A${r1},${r1} 0 0,1 ${x2},${y2} L${x3},${y3} A${r2},${r2} 0 0,0 ${x4},${y4} Z" class="${cls}" onclick="processHit(${v}, ${m})"/>`;
            };
            group.innerHTML += arc(82, 74, i%2?'db-green':'db-red', 2);
            group.innerHTML += arc(74, 52, i%2?'db-seg-even':'db-seg-odd', 1);
            group.innerHTML += arc(52, 44, i%2?'db-green':'db-red', 3);
            group.innerHTML += arc(44, 12, i%2?'db-seg-even':'db-seg-odd', 1);
            const tx = 100 + 92 * Math.cos((angle + 9) * Math.PI / 180), ty = 100 + 92 * Math.sin((angle + 9) * Math.PI / 180);
            group.innerHTML += `<text x="${tx}" y="${ty}" class="db-text" text-anchor="middle" dominant-baseline="middle">${v}</text>`;
        });
    }

    function processHit(v, m) {
        if (currentDarts.length >= 3) return;
        
        // Save current state for undo
        stateHistory.push(JSON.parse(JSON.stringify(players)));
        
        let p = players[turn];
        let opp = players[1-turn];

        if (cricketTargets.includes(v)) {
            for(let i=0; i<m; i++) {
                if(p.marks[v] < 3) p.marks[v]++;
                else if(opp.marks[v] < 3) p.score += v;
            }
        }
        currentDarts.push(v * m);
        updateDisplay();
        checkWin();
    }

    function undoHit() {
        if(currentDarts.length === 0) return;
        players = stateHistory.pop();
        currentDarts.pop();
        updateDisplay();
    }

    function updateDisplay() {
        // Highlight active column
        document.getElementById('col-0').classList.toggle('active', turn === 0);
        document.getElementById('col-1').classList.toggle('active', turn === 1);
        document.getElementById('active-tag').innerText = `TURN: ${players[turn].name}`;

        // Update Marks and Scores
        players.forEach((p, pi) => {
            document.getElementById(`pts-${pi}`).innerText = p.score;
            cricketTargets.forEach(t => {
                let m = p.marks[t], sym = "-";
                if(m===1) sym="/"; if(m===2) sym="X"; if(m>=3) sym="â“§";
                let el = document.getElementById(`m${pi}-${t}`);
                el.innerText = sym;
                el.style.color = (m >= 3) ? "var(--accent)" : "var(--text)";
                el.style.borderColor = (m >= 3) ? "var(--accent)" : "var(--border)";
            });
        });

        // Update Bottom slots
        for(let i=0; i<3; i++) {
            document.getElementById(`ds${i}`).innerText = currentDarts[i] ?? "-";
        }

        // Submit Button state
        const btn = document.getElementById('sub-btn');
        btn.style.opacity = currentDarts.length === 3 ? "1" : "0.2";
        btn.style.pointerEvents = currentDarts.length === 3 ? "auto" : "none";
    }

    function nextTurn() {
        turn = 1 - turn;
        currentDarts = [];
        stateHistory = [];
        updateDisplay();
    }

    function checkWin() {
        let p = players[turn], opp = players[1-turn];
        const allClosed = cricketTargets.every(t => p.marks[t] >= 3);
        if (allClosed && p.score >= opp.score) {
            document.getElementById('winner-name').innerText = p.name;
            nav('scr-win');
        }
    }
</script>
</body>
</html>